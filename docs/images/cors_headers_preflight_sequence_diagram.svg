<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="816px" preserveAspectRatio="none" style="width:802px;height:816px;background:#FFFFFF;" version="1.1" viewBox="0 0 802 816" width="802px" zoomAndPan="magnify"><defs/><g><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="653.9219" width="8" x="19.9551" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="23" x2="23" y1="81.2969" y2="735.2188"/></g><g><title>Regular Web App</title><rect fill="#000000" fill-opacity="0.00000" height="653.9219" width="8" x="158.2764" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="161.7139" x2="161.7139" y1="81.2969" y2="735.2188"/></g><g><title>External Resource Server</title><rect fill="#000000" fill-opacity="0.00000" height="653.9219" width="8" x="569.293" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="572.8013" x2="572.8013" y1="81.2969" y2="735.2188"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="5" y="77.9951">User</text><ellipse cx="23.9551" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.9551,21.5 L23.9551,48.5 M10.9551,29.5 L36.9551,29.5 M23.9551,48.5 L10.9551,63.5 M23.9551,48.5 L36.9551,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="5" y="747.2139">User</text><ellipse cx="23.9551" cy="759.0156" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.9551,767.0156 L23.9551,794.0156 M10.9551,775.0156 L36.9551,775.0156 M23.9551,794.0156 L10.9551,809.0156 M23.9551,794.0156 L36.9551,809.0156 " fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="App"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="195.125" x="64.7139" y="33.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121.9189" x="101.3169" y="53.6982">Regular Web App</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181.125" x="71.7139" y="69.9951">(https://ionutbalosin.com)</text></g><g class="participant participant-tail" data-participant="App"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="195.125" x="64.7139" y="734.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121.9189" x="101.3169" y="754.2139">Regular Web App</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181.125" x="71.7139" y="770.5107">(https://ionutbalosin.com)</text></g><g class="participant participant-head" data-participant="Api"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="326.9834" x="409.8013" y="33.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="178.2813" x="484.1523" y="53.6982">External Resource Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="312.9834" x="416.8013" y="69.9951">(https://api.ionutbalosin.cloud-provider.com)</text></g><g class="participant participant-tail" data-participant="Api"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="326.9834" x="409.8013" y="734.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="178.2813" x="484.1523" y="754.2139">External Resource Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="312.9834" x="416.8013" y="770.5107">(https://api.ionutbalosin.cloud-provider.com)</text></g><g class="message" data-participant-1="User" data-participant-2="App"><polygon fill="#181818" points="150.2764,108.4297,160.2764,112.4297,150.2764,116.4297,154.2764,112.4297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="23.9551" x2="156.2764" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.3213" x="30.9551" y="107.3638">Request resource</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="795.8135" x="0" y="140.9961"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="795.8135" y1="140.9961" y2="140.9961"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="795.8135" y1="143.9961" y2="143.9961"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="147.3071" x="324.2532" y="130.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128.7813" x="330.2532" y="146.4966">Preflight Request</text><g class="message" data-participant-1="App" data-participant-2="Api"><polygon fill="#181818" points="561.293,180.6953,571.293,184.6953,561.293,188.6953,565.293,184.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="162.2764" x2="567.293" y1="184.6953" y2="184.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.3667" x="169.2764" y="179.6294">OPTIONS /resource</text></g><path d="M578,197.6953 L578,237.6953 L760,237.6953 L760,207.6953 L750,197.6953 L578,197.6953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M750,197.6953 L750,207.6953 L760,207.6953 L750,197.6953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.7129" x="584" y="214.7622">Check if CORS is allowed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.3369" x="584" y="229.895">for the actual request</text><g class="message" data-participant-1="Api" data-participant-2="Api"><line style="stroke:#181818;stroke-width:1;" x1="573.293" x2="615.293" y1="294.3594" y2="294.3594"/><line style="stroke:#181818;stroke-width:1;" x1="615.293" x2="615.293" y1="294.3594" y2="307.3594"/><line style="stroke:#181818;stroke-width:1;" x1="574.293" x2="615.293" y1="307.3594" y2="307.3594"/><polygon fill="#181818" points="584.293,303.3594,574.293,307.3594,584.293,311.3594,580.293,307.3594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0767" x="580.293" y="259.0278">Access-Control-Allow-Origin</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.314" x="580.293" y="274.1606">Access-Control-Allow-Methods</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.8921" x="580.293" y="289.2935">Access-Control-Allow-Headers</text></g><path d="M578,320.3594 L578,345.3594 L790,345.3594 L790,330.3594 L780,320.3594 L578,320.3594 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M780,320.3594 L780,330.3594 L790,330.3594 L780,320.3594 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.8135" x="584" y="337.4263">Validate the preflight request</text><g class="message" data-participant-1="Api" data-participant-2="App"><polygon fill="#181818" points="173.2764,413.0234,163.2764,417.0234,173.2764,421.0234,169.2764,417.0234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="167.2764" x2="572.293" y1="417.0234" y2="417.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.7026" x="179.2764" y="366.5591">200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346.6328" x="179.2764" y="381.6919">Access-Control-Allow-Origin: https://ionutbalosin.com</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.584" x="179.2764" y="396.8247">Access-Control-Allow-Methods: GET, POST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="387.0166" x="179.2764" y="411.9575">Access-Control-Allow-Headers: Content-Type, Authorization</text></g><path d="M167,430.0234 L167,455.0234 L316,455.0234 L316,440.0234 L306,430.0234 L167,430.0234 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M306,430.0234 L306,440.0234 L316,440.0234 L306,430.0234 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.5083" x="173" y="447.0903">Preflight succeeded</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="795.8135" x="0" y="480.7227"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="795.8135" y1="480.7227" y2="480.7227"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="795.8135" y1="483.7227" y2="483.7227"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="129.6733" x="333.0701" y="470.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.1475" x="339.0701" y="486.2231">Actual Request</text><g class="message" data-participant-1="App" data-participant-2="Api"><polygon fill="#181818" points="561.293,520.4219,571.293,524.4219,561.293,528.4219,565.293,524.4219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="162.2764" x2="567.293" y1="524.4219" y2="524.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.3213" x="169.2764" y="519.356">Request resource</text></g><g class="message" data-participant-1="Api" data-participant-2="Api"><line style="stroke:#181818;stroke-width:1;" x1="573.293" x2="615.293" y1="553.5547" y2="553.5547"/><line style="stroke:#181818;stroke-width:1;" x1="615.293" x2="615.293" y1="553.5547" y2="566.5547"/><line style="stroke:#181818;stroke-width:1;" x1="574.293" x2="615.293" y1="566.5547" y2="566.5547"/><polygon fill="#181818" points="584.293,562.5547,574.293,566.5547,584.293,570.5547,580.293,566.5547" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.0532" x="580.293" y="548.4888">Validate Access Token</text></g><path d="M578,579.5547 L578,619.5547 L746,619.5547 L746,589.5547 L736,579.5547 L578,579.5547 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M736,579.5547 L736,589.5547 L746,589.5547 L736,579.5547 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.4941" x="584" y="596.6216">Validation can be local</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.4731" x="584" y="611.7544">or by calling the IdP</text><g class="message" data-participant-1="Api" data-participant-2="Api"><line style="stroke:#181818;stroke-width:1;" x1="573.293" x2="615.293" y1="645.9531" y2="645.9531"/><line style="stroke:#181818;stroke-width:1;" x1="615.293" x2="615.293" y1="645.9531" y2="658.9531"/><line style="stroke:#181818;stroke-width:1;" x1="574.293" x2="615.293" y1="658.9531" y2="658.9531"/><polygon fill="#181818" points="584.293,654.9531,574.293,658.9531,584.293,662.9531,580.293,658.9531" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.6646" x="580.293" y="640.8872">Check user roles/permissions</text></g><g class="message" data-participant-1="Api" data-participant-2="App"><polygon fill="#181818" points="173.2764,684.0859,163.2764,688.0859,173.2764,692.0859,169.2764,688.0859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="167.2764" x2="572.293" y1="688.0859" y2="688.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.5898" x="179.2764" y="683.02">Grant resource access</text></g><g class="message" data-participant-1="App" data-participant-2="User"><polygon fill="#181818" points="34.9551,713.2188,24.9551,717.2188,34.9551,721.2188,30.9551,717.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="28.9551" x2="161.2764" y1="717.2188" y2="717.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.4868" x="40.9551" y="712.1528">Resource</text></g><!--SRC=[VLF1JkCm4BtdAqQSG28KSOnKfAX2fKAGgWtifHVNcJOMnlQERNRPhsVSB25LMwwUcVVUl3SMCbY2Pu-KEK51IUM42N2sm6tKWk0Nhg5qRcNEsn2SBqOZPKqCQw6jL-PAshUBCn0-zUm3tFqDI4PeMA2taIJ24kaTQO0adBhQHzCsDhaZ-wuQf26uohAa4VBRn0G5e_wEw0FGV_Gi6uzXJhZHQjk6lZmUPwb_DwOAgERrh7fQmgWVCpOWq6x6RhgcIOlo5TG69jLY2Sg3qDh-mMPbDcnLQ164394teuuaOmhLKvHIelVvn9f0LkTbciqhPb1cPOuM7p6qjl4dglSes0j_JEYBqAeH_9mqkNxtGrckW9lhQwWUJd1qyWeu5V7FmWkOtjMNCA-MzSyxiBNyZ2RazOV3IoWZpvFw9m8J7Yp8eh_pz95niS5cbtFP-Nyqv6EtyPqF35phf49jN_6GVT39ua0A0si4RQNGAyDdiFxWDwsLsUxSdpNpVPRkY6AwMVO1_SWXlIdl6SmFWk7EAQN_ygMLRokf-bee7NtHVw5F]--></g></svg>