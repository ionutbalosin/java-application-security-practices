<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="668px" preserveAspectRatio="none" style="width:1011px;height:668px;background:#FFFFFF;" version="1.1" viewBox="0 0 1011 668" width="1011px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="125.6641" style="stroke:#000000;stroke-width:1.5;" width="640.5962" x="365.0942" y="198.6953"/><rect fill="none" height="190.6016" style="stroke:#000000;stroke-width:1.5;" width="639.6318" x="10" y="380.4922"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="506.7969" width="8" x="34.9551" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="38" x2="38" y1="81.2969" y2="588.0938"/></g><g><title>Regular Web</title><rect fill="#000000" fill-opacity="0.00000" height="506.7969" width="8" x="173.2764" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="177.2173" x2="177.2173" y1="81.2969" y2="588.0938"/></g><g><title>Resource Server</title><rect fill="#000000" fill-opacity="0.00000" height="506.7969" width="8" x="435.9673" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="439.0942" x2="439.0942" y1="81.2969" y2="588.0938"/></g><g><title>IdP Provider</title><rect fill="#000000" fill-opacity="0.00000" height="506.7969" width="8" x="738.519" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="741.9927" x2="741.9927" y1="81.2969" y2="588.0938"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="20" y="77.9951">User</text><ellipse cx="38.9551" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38.9551,21.5 L38.9551,48.5 M25.9551,29.5 L51.9551,29.5 M38.9551,48.5 L25.9551,63.5 M38.9551,48.5 L51.9551,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="20" y="600.0889">User</text><ellipse cx="38.9551" cy="611.8906" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38.9551,619.8906 L38.9551,646.8906 M25.9551,627.8906 L51.9551,627.8906 M38.9551,646.8906 L25.9551,661.8906 M38.9551,646.8906 L51.9551,661.8906 " fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="App"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104.1182" x="125.2173" y="33.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.1182" x="132.2173" y="53.6982">Regular Web</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27.3506" x="163.6011" y="69.9951">App</text></g><g class="participant participant-tail" data-participant="App"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104.1182" x="125.2173" y="587.0938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.1182" x="132.2173" y="607.0889">Regular Web</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27.3506" x="163.6011" y="623.3857">App</text></g><g class="participant participant-head" data-participant="Api"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="129.7461" x="375.0942" y="33.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115.5" x="382.2173" y="53.6982">Resource Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115.7461" x="382.0942" y="69.9951">(Application API)</text></g><g class="participant participant-tail" data-participant="Api"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="129.7461" x="375.0942" y="587.0938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115.5" x="382.2173" y="607.0889">Resource Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115.7461" x="382.0942" y="623.3857">(Application API)</text></g><g class="participant participant-head" data-participant="IdP"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="169.0527" x="657.9927" y="33.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.1025" x="700.4678" y="53.6982">IdP Provider</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155.0527" x="664.9927" y="69.9951">(Authorization Server)</text></g><g class="participant participant-tail" data-participant="IdP"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="169.0527" x="657.9927" y="587.0938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.1025" x="700.4678" y="607.0889">IdP Provider</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155.0527" x="664.9927" y="623.3857">(Authorization Server)</text></g><g class="message" data-participant-1="User" data-participant-2="App"><polygon fill="#181818" points="165.2764,108.4297,175.2764,112.4297,165.2764,116.4297,169.2764,112.4297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="38.9551" x2="171.2764" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.3213" x="45.9551" y="107.3638">Request resource</text></g><g class="message" data-participant-1="App" data-participant-2="Api"><polygon fill="#181818" points="427.9673,137.5625,437.9673,141.5625,427.9673,145.5625,431.9673,141.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="177.2764" x2="433.9673" y1="141.5625" y2="141.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238.6909" x="184.2764" y="136.4966">Request resource with Access Token</text></g><g class="message" data-participant-1="Api" data-participant-2="Api"><line style="stroke:#181818;stroke-width:1;" x1="439.9673" x2="481.9673" y1="170.6953" y2="170.6953"/><line style="stroke:#181818;stroke-width:1;" x1="481.9673" x2="481.9673" y1="170.6953" y2="183.6953"/><line style="stroke:#181818;stroke-width:1;" x1="440.9673" x2="481.9673" y1="183.6953" y2="183.6953"/><polygon fill="#181818" points="450.9673,179.6953,440.9673,183.6953,450.9673,187.6953,446.9673,183.6953" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="284.6226" x="446.9673" y="165.6294">Extract JWT Header (to get 'alg' and key ID)</text></g><path d="M365.0942,198.6953 L429.5371,198.6953 L429.5371,205.8281 L419.5371,215.8281 L365.0942,215.8281 L365.0942,198.6953 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="125.6641" style="stroke:#000000;stroke-width:1.5;" width="640.5962" x="365.0942" y="198.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="380.0942" y="211.7622">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="134.707" x="444.5371" y="210.9058">[JWKS Cache Expired]</text><g class="message" data-participant-1="Api" data-participant-2="IdP"><polygon fill="#181818" points="730.519,232.9609,740.519,236.9609,730.519,240.9609,734.519,236.9609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="439.9673" x2="736.519" y1="236.9609" y2="236.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224.9673" x="446.9673" y="231.895">Fetch JWKS against JWKS endpoint</text></g><path d="M747,249.9609 L747,289.9609 L995,289.9609 L995,259.9609 L985,249.9609 L747,249.9609 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M985,249.9609 L985,259.9609 L995,259.9609 L985,249.9609 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0645" x="753" y="267.0278">Provide public keys</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.6904" x="753" y="282.1606">to validate Access Token signature</text><g class="message" data-participant-1="IdP" data-participant-2="Api"><polygon fill="#181818" points="450.9673,312.3594,440.9673,316.3594,450.9673,320.3594,446.9673,316.3594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="444.9673" x2="741.519" y1="316.3594" y2="316.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.5483" x="456.9673" y="311.2935">Return JWKS</text></g><g class="message" data-participant-1="Api" data-participant-2="Api"><line style="stroke:#181818;stroke-width:1;" x1="439.9673" x2="481.9673" y1="352.4922" y2="352.4922"/><line style="stroke:#181818;stroke-width:1;" x1="481.9673" x2="481.9673" y1="352.4922" y2="365.4922"/><line style="stroke:#181818;stroke-width:1;" x1="440.9673" x2="481.9673" y1="365.4922" y2="365.4922"/><polygon fill="#181818" points="450.9673,361.4922,440.9673,365.4922,450.9673,369.4922,446.9673,365.4922" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="288.5518" x="446.9673" y="347.4263">Validate Access Token signature using JWKS</text></g><path d="M10,380.4922 L74.4429,380.4922 L74.4429,387.625 L64.4429,397.625 L10,397.625 L10,380.4922 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="190.6016" style="stroke:#000000;stroke-width:1.5;" width="639.6318" x="10" y="380.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="393.5591">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="106.0308" x="89.4429" y="392.7026">[Signature Valid]</text><g class="message" data-participant-1="Api" data-participant-2="Api"><line style="stroke:#181818;stroke-width:1;" x1="439.9673" x2="481.9673" y1="418.7578" y2="418.7578"/><line style="stroke:#181818;stroke-width:1;" x1="481.9673" x2="481.9673" y1="418.7578" y2="431.7578"/><line style="stroke:#181818;stroke-width:1;" x1="440.9673" x2="481.9673" y1="431.7578" y2="431.7578"/><polygon fill="#181818" points="450.9673,427.7578,440.9673,431.7578,450.9673,435.7578,446.9673,431.7578" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.6646" x="446.9673" y="413.6919">Check user roles/permissions</text></g><g class="message" data-participant-1="Api" data-participant-2="App"><polygon fill="#181818" points="188.2764,456.8906,178.2764,460.8906,188.2764,464.8906,184.2764,460.8906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="182.2764" x2="438.9673" y1="460.8906" y2="460.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.7729" x="194.2764" y="455.8247">Grant access to resource</text></g><g class="message" data-participant-1="App" data-participant-2="User"><polygon fill="#181818" points="49.9551,486.0234,39.9551,490.0234,49.9551,494.0234,45.9551,490.0234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.9551" x2="176.2764" y1="490.0234" y2="490.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.4868" x="55.9551" y="484.9575">Resource</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="10" x2="649.6318" y1="499.0234" y2="499.0234"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="116.6118" x="15" y="509.2339">[Signature Invalid]</text><g class="message" data-participant-1="Api" data-participant-2="App"><polygon fill="#181818" points="188.2764,529.9609,178.2764,533.9609,188.2764,537.9609,184.2764,533.9609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="182.2764" x2="438.9673" y1="533.9609" y2="533.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0894" x="194.2764" y="528.895">Deny access (invalid token)</text></g><g class="message" data-participant-1="App" data-participant-2="User"><polygon fill="#181818" points="49.9551,559.0938,39.9551,563.0938,49.9551,567.0938,45.9551,563.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.9551" x2="176.2764" y1="563.0938" y2="563.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.2017" x="55.9551" y="558.0278">Error</text></g><!--SRC=[VL9DJm8n4BtlhvXu0Gx6EmSJ0gZeXG3AXSlG7NSdhEqwxQBuwvrkLm9AxAL9vttCcocQu0IUFKbMemGsNACDSBMWegbGO4tRZHtLzHMW1xr_exnhn10iIVOa6zjNICK60piBe_biqF7ud3VBvp0Nj-SyaPfGEk6lH4jQYQd0B8lTmVLjj8SXBEYz8Hz0EkyiFhTLlb253mubZ8mXxs7bTcIp23pYfvz1q0HuNA_WWL3xWNvmK5207bP53z3ciAC3p2Q33Ai8V5h264r9ogrPACz0JoSQWmtXZe8f4n8BPEix6jcyTcn3ox0k40WNPG3tsX6xcK3TR7MAqTTlhBQpnufpLFnf4F1SM0oDKAiN5Kx6eE-sTStKzJppo_zgq7YsHUB6nCjZeIMUnarwuvBCJbawEt4L-PkQv8szrsNwStJStxt4Bu39MhCTzvYGxIxRZSSKNOagJoTzpEp-RoTHUqBsy2FTvuHI3uqtk20_5N4In_CD]--></g></svg>